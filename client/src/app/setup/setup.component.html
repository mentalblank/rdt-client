<section class="hero is-dark is-fullheight">
  <div class="hero-body">
    <div class="container">
      <div class="columns is-centered">
        <div class="column is-5-tablet is-5-desktop is-5-widescreen">
          <img src="assets/logo.png" />
          @if (step === 1) {
            <div class="box">
              <div class="notification is-primary">
                Welcome to RDTClient. Please create your account by entering a username and password.
              </div>
              <form (ngSubmit)="setup()">
                <div class="field">
                  <label for="userName" class="label">Username</label>
                  <div class="control has-icons-left">
                    <input
                      type="text"
                      placeholder=""
                      class="input"
                      name="userName"
                      id="userName"
                      [(ngModel)]="userName"
                      required
                    />
                    <span class="icon is-small is-left">
                      <i class="fa fa-envelope"></i>
                    </span>
                  </div>
                </div>
                <div class="field">
                  <label for="password" class="label">Password</label>
                  <div class="control has-icons-left">
                    <input
                      type="password"
                      class="input"
                      required
                      name="password"
                      id="password"
                      [(ngModel)]="password"
                    />
                    <span class="icon is-small is-left">
                      <i class="fa fa-lock"></i>
                    </span>
                  </div>
                </div>
                <div class="field">
                  <button class="button is-success" [ngClass]="{ 'is-loading': working }" [disabled]="working">
                    Setup
                  </button>
                </div>
                @if (error?.length > 0) {
                  <div class="notification is-danger is-light">
                    {{ error }}
                  </div>
                }
              </form>
            </div>
          }

          @if (step === 2) {
            <div class="box">
              <div class="notification is-primary">
                To be able to use RDTClient you need a premium subscription to download torrents.
                <br /><br />
                Enable the providers you want to use and enter your API token.
              </div>
              @for (p of providers; track p.id) {
                <div class="field box">
                  <label class="checkbox">
                    <input type="checkbox" [(ngModel)]="p.enabled" />
                    <strong>{{ p.name }}</strong>
                  </label>
                  @if (p.enabled) {
                    <div class="field" style="margin-top: 10px">
                      <label class="label">API Private Token</label>
                      <div class="control">
                        <input type="text" class="input" [(ngModel)]="p.token" placeholder="Enter API Token" />
                      </div>
                      @if (p.id === 0) {
                        <p class="help">
                          Find your API key here:
                          <a href="https://real-debrid.com/apitoken" target="_blank" rel="noopener"
                            >https://real-debrid.com/apitoken</a
                          >.
                        </p>
                      }
                      @if (p.id === 1) {
                        <p class="help">
                          Find your API key here:
                          <a href="https://alldebrid.com/apikeys/" target="_blank" rel="noopener"
                            >https://alldebrid.com/apikeys/</a
                          >.
                        </p>
                      }
                      @if (p.id === 2) {
                        <p class="help">
                          Find your API key here:
                          <a href="https://www.premiumize.me/account" target="_blank" rel="noopener"
                            >https://www.premiumize.me/account</a
                          >.
                        </p>
                      }
                      @if (p.id === 3) {
                        <p class="help">
                          Find your API key here:
                          <a href="https://torbox.app/settings" target="_blank" rel="noopener"
                            >https://torbox.app/settings</a
                          >.
                        </p>
                      }
                      @if (p.id === 4) {
                        <p class="help">
                          Find your API key here:
                          <a href="https://debrid-link.com/webapp/apikey" target="_blank" rel="noopener"
                            >https://debrid-link.com/webapp/apikey</a
                          >.
                        </p>
                      }
                    </div>
                  }
                </div>
              }
              <div class="field">
                <button
                  class="button is-success is-fullwidth"
                  (click)="setToken()"
                  [ngClass]="{ 'is-loading': working }"
                  [disabled]="working"
                >
                  Save and Finish
                </button>
              </div>

              @if (error?.length > 0) {
                <div class="notification is-danger is-light">
                  {{ error }}
                </div>
              }
            </div>
          }

          @if (step === 3) {
            <div class="box">
              <div class="notification is-primary">
                You are now connected! To setup Radarr or Sonarr, please following the instructions here:
                <a href="https://github.com/mentalblank/rdt-client/" target="_blank" rel="noopener"
                  >https://github.com/mentalblank/rdt-client/</a
                >.
              </div>
              <div class="field">
                <button
                  class="button is-success"
                  (click)="close()"
                  [ngClass]="{ 'is-loading': working }"
                  [disabled]="working"
                >
                  OK
                </button>
              </div>
            </div>
          }
        </div>
      </div>
    </div>
  </div>
</section>
